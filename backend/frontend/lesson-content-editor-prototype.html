<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VidPOD - Lesson Content Editor</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/lesson-styles.css">
</head>
<body>
    <!-- Navigation will auto-load here -->

    <div class="container">
        <!-- Editor Header -->
        <div class="editor-header">
            <div class="editor-title-section">
                <div class="breadcrumb">
                    <a href="course-builder-prototype.html">Course Builder</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span class="current">Lesson Editor</span>
                </div>
                <h1>üìù Lesson Content Editor</h1>
                <div class="lesson-info">
                    <span class="lesson-course">Podcast Journalism 101</span>
                    <span class="lesson-separator">‚Ä¢</span>
                    <span class="lesson-title">Module 1, Lesson 2: Podcast Types and Formats</span>
                </div>
            </div>
            <div class="editor-actions">
                <button class="btn btn-secondary" onclick="saveDraft()">
                    <span class="icon">üíæ</span>
                    Save Draft
                    <span class="save-indicator" id="saveIndicator">Saved</span>
                </button>
                <button class="btn btn-secondary" onclick="previewLesson()">
                    <span class="icon">üëÅÔ∏è</span>
                    Preview
                </button>
                <button class="btn btn-primary" onclick="publishLesson()">
                    <span class="icon">üöÄ</span>
                    Publish
                </button>
            </div>
        </div>

        <!-- Editor Layout -->
        <div class="editor-layout">
            <!-- Editor Sidebar -->
            <div class="editor-sidebar">
                <!-- Lesson Navigation -->
                <div class="sidebar-section">
                    <h3>üìö Course Navigation</h3>
                    <div class="lesson-navigation">
                        <div class="lesson-nav-item completed">
                            <span class="lesson-status">‚úì</span>
                            <span class="lesson-nav-title">1.1 What is Podcasting?</span>
                        </div>
                        <div class="lesson-nav-item current">
                            <span class="lesson-status">‚úèÔ∏è</span>
                            <span class="lesson-nav-title">1.2 Podcast Types and Formats</span>
                        </div>
                        <div class="lesson-nav-item">
                            <span class="lesson-status">‚óØ</span>
                            <span class="lesson-nav-title">1.3 Finding Your Niche</span>
                        </div>
                        <div class="lesson-nav-item">
                            <span class="lesson-status">‚óØ</span>
                            <span class="lesson-nav-title">1.4 Module Assessment</span>
                        </div>
                    </div>
                </div>

                <!-- Content Elements Library -->
                <div class="sidebar-section">
                    <h3>üß© Content Elements</h3>
                    <div class="elements-library">
                        <div class="element-category">
                            <h4>Text & Media</h4>
                            <div class="element-item" draggable="true" data-type="text">
                                <span class="element-icon">üìù</span>
                                <span class="element-name">Rich Text</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="video">
                                <span class="element-icon">üé•</span>
                                <span class="element-name">Video</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="audio">
                                <span class="element-icon">üéß</span>
                                <span class="element-name">Audio</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="image">
                                <span class="element-icon">üñºÔ∏è</span>
                                <span class="element-name">Image</span>
                            </div>
                        </div>

                        <div class="element-category">
                            <h4>Interactive</h4>
                            <div class="element-item" draggable="true" data-type="quiz">
                                <span class="element-icon">‚ùì</span>
                                <span class="element-name">Quiz</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="poll">
                                <span class="element-icon">üìä</span>
                                <span class="element-name">Poll</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="exercise">
                                <span class="element-icon">üéØ</span>
                                <span class="element-name">Exercise</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="discussion">
                                <span class="element-icon">üí¨</span>
                                <span class="element-name">Discussion</span>
                            </div>
                        </div>

                        <div class="element-category">
                            <h4>Structure</h4>
                            <div class="element-item" draggable="true" data-type="section">
                                <span class="element-icon">üìÑ</span>
                                <span class="element-name">Section</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="callout">
                                <span class="element-icon">üí°</span>
                                <span class="element-name">Callout</span>
                            </div>
                            <div class="element-item" draggable="true" data-type="divider">
                                <span class="element-icon">‚ûñ</span>
                                <span class="element-name">Divider</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lesson Settings -->
                <div class="sidebar-section">
                    <h3>‚öôÔ∏è Lesson Settings</h3>
                    <div class="lesson-settings">
                        <div class="setting-item">
                            <label class="setting-label">Lesson Status</label>
                            <select class="form-control" id="lessonStatus">
                                <option value="draft" selected>Draft</option>
                                <option value="review">Under Review</option>
                                <option value="published">Published</option>
                                <option value="archived">Archived</option>
                            </select>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">Estimated Duration</label>
                            <div class="duration-inputs">
                                <input type="number" class="form-control" value="45" min="1" max="999">
                                <select class="form-control">
                                    <option value="minutes" selected>minutes</option>
                                    <option value="hours">hours</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" checked>
                                Allow downloads
                            </label>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox">
                                Require completion
                            </label>
                        </div>

                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox">
                                Enable comments
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Editor Area -->
            <div class="editor-main">
                <!-- Editor Toolbar -->
                <div class="editor-toolbar-main">
                    <div class="toolbar-section">
                        <button class="toolbar-btn" onclick="undoAction()" title="Undo">
                            <span class="icon">‚Ü∂</span>
                        </button>
                        <button class="toolbar-btn" onclick="redoAction()" title="Redo">
                            <span class="icon">‚Ü∑</span>
                        </button>
                    </div>
                    
                    <div class="toolbar-divider"></div>
                    
                    <div class="toolbar-section">
                        <button class="toolbar-btn" onclick="addElement('text')" title="Add Text">
                            <span class="icon">üìù</span>
                        </button>
                        <button class="toolbar-btn" onclick="addElement('video')" title="Add Video">
                            <span class="icon">üé•</span>
                        </button>
                        <button class="toolbar-btn" onclick="addElement('audio')" title="Add Audio">
                            <span class="icon">üéß</span>
                        </button>
                        <button class="toolbar-btn" onclick="addElement('quiz')" title="Add Quiz">
                            <span class="icon">‚ùì</span>
                        </button>
                    </div>
                    
                    <div class="toolbar-divider"></div>
                    
                    <div class="toolbar-section">
                        <button class="toolbar-btn" onclick="togglePreview()" title="Toggle Preview" id="previewToggle">
                            <span class="icon">üëÅÔ∏è</span>
                        </button>
                        <button class="toolbar-btn" onclick="showOutline()" title="Lesson Outline">
                            <span class="icon">üìã</span>
                        </button>
                    </div>

                    <div class="toolbar-spacer"></div>

                    <div class="toolbar-section">
                        <div class="word-count">
                            <span id="wordCount">1,247</span> words
                        </div>
                        <div class="auto-save-status" id="autoSaveStatus">
                            <span class="status-icon">‚úì</span>
                            <span class="status-text">Auto-saved</span>
                        </div>
                    </div>
                </div>

                <!-- Content Canvas -->
                <div class="content-canvas" id="contentCanvas">
                    <!-- Lesson Header -->
                    <div class="lesson-header-editor">
                        <div class="form-group">
                            <input type="text" class="lesson-title-input" 
                                   value="Podcast Types and Formats" placeholder="Enter lesson title...">
                        </div>
                        
                        <div class="form-group">
                            <textarea class="lesson-description-input" 
                                      placeholder="Brief description of what students will learn in this lesson..."
                                      rows="2">Explore the diverse world of podcast formats and discover which style best fits your content and audience goals.</textarea>
                        </div>
                    </div>

                    <!-- Content Blocks Container -->
                    <div class="content-blocks" id="contentBlocks">
                        
                        <!-- Text Block Example -->
                        <div class="content-block" data-block-id="1" data-type="text">
                            <div class="block-controls">
                                <div class="block-handle" title="Drag to reorder">‚â°</div>
                                <div class="block-type-indicator">üìù Text</div>
                                <div class="block-actions">
                                    <button class="block-btn" onclick="duplicateBlock(1)" title="Duplicate">üìã</button>
                                    <button class="block-btn" onclick="moveBlockUp(1)" title="Move up">‚Üë</button>
                                    <button class="block-btn" onclick="moveBlockDown(1)" title="Move down">‚Üì</button>
                                    <button class="block-btn danger" onclick="deleteBlock(1)" title="Delete">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="block-content">
                                <div class="rich-text-editor">
                                    <div class="rte-toolbar">
                                        <button class="rte-btn" onclick="formatText('bold')"><b>B</b></button>
                                        <button class="rte-btn" onclick="formatText('italic')"><i>I</i></button>
                                        <button class="rte-btn" onclick="formatText('underline')"><u>U</u></button>
                                        <span class="toolbar-separator">|</span>
                                        <button class="rte-btn" onclick="formatText('h1')">H1</button>
                                        <button class="rte-btn" onclick="formatText('h2')">H2</button>
                                        <button class="rte-btn" onclick="formatText('h3')">H3</button>
                                        <span class="toolbar-separator">|</span>
                                        <button class="rte-btn" onclick="insertList('ul')">‚Ä¢ List</button>
                                        <button class="rte-btn" onclick="insertList('ol')">1. List</button>
                                        <span class="toolbar-separator">|</span>
                                        <button class="rte-btn" onclick="insertLink()">üîó</button>
                                        <button class="rte-btn" onclick="insertImage()">üñºÔ∏è</button>
                                        <button class="rte-btn" onclick="insertEmbed()">üìπ</button>
                                    </div>
                                    <div class="rte-content" contenteditable="true">
                                        <h2>Understanding Podcast Formats</h2>
                                        <p>Podcasts come in many different formats, each with its own unique strengths and characteristics. Understanding these formats will help you choose the right style for your content and audience.</p>
                                        
                                        <h3>Popular Podcast Formats</h3>
                                        <ul>
                                            <li><strong>Interview Format:</strong> Conversations with guests, experts, or interesting personalities</li>
                                            <li><strong>Solo/Monologue:</strong> Single host sharing insights, stories, or teaching</li>
                                            <li><strong>Co-hosted:</strong> Multiple hosts discussing topics with dynamic conversation</li>
                                            <li><strong>Panel Discussion:</strong> Multiple participants exploring topics from different angles</li>
                                            <li><strong>Narrative/Documentary:</strong> Storytelling with production elements and sound design</li>
                                            <li><strong>News/Current Events:</strong> Regular updates and analysis of recent developments</li>
                                        </ul>
                                        
                                        <p>Each format has different production requirements, time commitments, and appeals to different audience preferences.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Video Block Example -->
                        <div class="content-block" data-block-id="2" data-type="video">
                            <div class="block-controls">
                                <div class="block-handle" title="Drag to reorder">‚â°</div>
                                <div class="block-type-indicator">üé• Video</div>
                                <div class="block-actions">
                                    <button class="block-btn" onclick="duplicateBlock(2)" title="Duplicate">üìã</button>
                                    <button class="block-btn" onclick="moveBlockUp(2)" title="Move up">‚Üë</button>
                                    <button class="block-btn" onclick="moveBlockDown(2)" title="Move down">‚Üì</button>
                                    <button class="block-btn danger" onclick="deleteBlock(2)" title="Delete">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="block-content">
                                <div class="video-block-editor">
                                    <div class="video-preview">
                                        <div class="video-placeholder">
                                            <div class="video-info">
                                                <span class="video-icon">üé•</span>
                                                <h4>Podcast Format Examples</h4>
                                                <p>Duration: 8:32 ‚Ä¢ Size: 124 MB</p>
                                                <div class="video-actions">
                                                    <button class="btn btn-secondary btn-sm" onclick="editVideoSettings(2)">Settings</button>
                                                    <button class="btn btn-primary btn-sm" onclick="replaceVideo(2)">Replace</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="video-settings">
                                        <div class="form-group">
                                            <label class="form-label">Video Title</label>
                                            <input type="text" class="form-control" value="Podcast Format Examples">
                                        </div>
                                        
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label">Start Time</label>
                                                <input type="text" class="form-control" value="0:00" placeholder="0:00">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">End Time</label>
                                                <input type="text" class="form-control" value="" placeholder="Auto">
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="setting-label">
                                                <input type="checkbox" checked>
                                                Auto-play when lesson loads
                                            </label>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="setting-label">
                                                <input type="checkbox" checked>
                                                Show video controls
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Interactive Quiz Block -->
                        <div class="content-block" data-block-id="3" data-type="quiz">
                            <div class="block-controls">
                                <div class="block-handle" title="Drag to reorder">‚â°</div>
                                <div class="block-type-indicator">‚ùì Quiz</div>
                                <div class="block-actions">
                                    <button class="block-btn" onclick="duplicateBlock(3)" title="Duplicate">üìã</button>
                                    <button class="block-btn" onclick="moveBlockUp(3)" title="Move up">‚Üë</button>
                                    <button class="block-btn" onclick="moveBlockDown(3)" title="Move down">‚Üì</button>
                                    <button class="block-btn danger" onclick="deleteBlock(3)" title="Delete">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="block-content">
                                <div class="quiz-block-editor">
                                    <div class="quiz-header">
                                        <input type="text" class="form-control quiz-title" 
                                               placeholder="Quiz title..." value="Knowledge Check: Podcast Formats">
                                        <textarea class="form-control quiz-description" 
                                                  placeholder="Quiz description..." rows="2">Test your understanding of different podcast formats and their characteristics.</textarea>
                                    </div>
                                    
                                    <div class="quiz-questions">
                                        <div class="quiz-question" data-question="1">
                                            <div class="question-header">
                                                <span class="question-number">Question 1</span>
                                                <select class="form-control question-type">
                                                    <option value="multiple-choice" selected>Multiple Choice</option>
                                                    <option value="true-false">True/False</option>
                                                    <option value="short-answer">Short Answer</option>
                                                </select>
                                                <button class="btn-icon" onclick="deleteQuestion(1)">üóëÔ∏è</button>
                                            </div>
                                            
                                            <div class="question-content">
                                                <input type="text" class="form-control question-text" 
                                                       placeholder="Enter your question..." 
                                                       value="Which podcast format typically involves multiple hosts discussing topics with dynamic conversation?">
                                                
                                                <div class="question-options">
                                                    <div class="option-item">
                                                        <input type="radio" name="q1" id="q1a" checked>
                                                        <input type="text" class="form-control option-text" value="Co-hosted format">
                                                        <span class="correct-indicator">‚úì Correct</span>
                                                        <button class="btn-icon" onclick="removeOption(this)">‚úï</button>
                                                    </div>
                                                    <div class="option-item">
                                                        <input type="radio" name="q1" id="q1b">
                                                        <input type="text" class="form-control option-text" value="Interview format">
                                                        <button class="btn-icon" onclick="toggleCorrect(this)">Make Correct</button>
                                                        <button class="btn-icon" onclick="removeOption(this)">‚úï</button>
                                                    </div>
                                                    <div class="option-item">
                                                        <input type="radio" name="q1" id="q1c">
                                                        <input type="text" class="form-control option-text" value="Solo monologue">
                                                        <button class="btn-icon" onclick="toggleCorrect(this)">Make Correct</button>
                                                        <button class="btn-icon" onclick="removeOption(this)">‚úï</button>
                                                    </div>
                                                </div>
                                                
                                                <div class="question-actions">
                                                    <button class="btn btn-secondary btn-sm" onclick="addOption(1)">Add Option</button>
                                                </div>
                                                
                                                <div class="question-settings">
                                                    <div class="form-group">
                                                        <label class="form-label">Explanation (optional)</label>
                                                        <textarea class="form-control" rows="2" 
                                                                  placeholder="Explain the correct answer...">Co-hosted formats feature multiple hosts who engage in dynamic conversations, bringing different perspectives and creating engaging dialogue.</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="quiz-actions">
                                        <button class="btn btn-secondary" onclick="addQuestion(3)">Add Question</button>
                                        <button class="btn btn-primary" onclick="previewQuiz(3)">Preview Quiz</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Audio Block Example -->
                        <div class="content-block" data-block-id="4" data-type="audio">
                            <div class="block-controls">
                                <div class="block-handle" title="Drag to reorder">‚â°</div>
                                <div class="block-type-indicator">üéß Audio</div>
                                <div class="block-actions">
                                    <button class="block-btn" onclick="duplicateBlock(4)" title="Duplicate">üìã</button>
                                    <button class="block-btn" onclick="moveBlockUp(4)" title="Move up">‚Üë</button>
                                    <button class="block-btn" onclick="moveBlockDown(4)" title="Move down">‚Üì</button>
                                    <button class="block-btn danger" onclick="deleteBlock(4)" title="Delete">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="block-content">
                                <div class="audio-block-editor">
                                    <div class="audio-upload-area" onclick="document.getElementById('audioFile4').click()">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üéß</span>
                                            <h4>Add Audio Content</h4>
                                            <p>Click to upload audio file or paste URL</p>
                                            <div class="upload-options">
                                                <button class="btn btn-primary" onclick="uploadAudio(4)">Upload File</button>
                                                <input type="url" class="form-control" placeholder="Or paste audio URL">
                                            </div>
                                        </div>
                                    </div>
                                    <input type="file" id="audioFile4" accept="audio/*" style="display: none;">
                                    
                                    <div class="audio-settings" style="display: none;">
                                        <div class="form-group">
                                            <label class="form-label">Audio Title</label>
                                            <input type="text" class="form-control" placeholder="Enter audio title">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="setting-label">
                                                <input type="checkbox">
                                                Auto-play when block is visible
                                            </label>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="setting-label">
                                                <input type="checkbox" checked>
                                                Show audio controls
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Drop Zone for New Content -->
                        <div class="content-drop-zone" id="dropZone">
                            <div class="drop-zone-content">
                                <span class="drop-icon">‚ûï</span>
                                <p>Drop content here or click to add new block</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Action Panel -->
        <div class="floating-panel" id="floatingPanel">
            <button class="fab-btn" onclick="togglePanel()" id="fabToggle">
                <span class="icon">‚ûï</span>
            </button>
            <div class="fab-menu" id="fabMenu" style="display: none;">
                <button class="fab-item" onclick="addElement('text')" title="Add Text">
                    <span class="icon">üìù</span>
                </button>
                <button class="fab-item" onclick="addElement('video')" title="Add Video">
                    <span class="icon">üé•</span>
                </button>
                <button class="fab-item" onclick="addElement('audio')" title="Add Audio">
                    <span class="icon">üéß</span>
                </button>
                <button class="fab-item" onclick="addElement('quiz')" title="Add Quiz">
                    <span class="icon">‚ùì</span>
                </button>
                <button class="fab-item" onclick="addElement('exercise')" title="Add Exercise">
                    <span class="icon">üéØ</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Media Library Modal -->
    <div id="mediaLibraryModal" class="modal" style="display: none;">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>üìÅ Media Library</h3>
                <button class="modal-close" onclick="closeMediaLibrary()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="media-library">
                    <div class="media-toolbar">
                        <div class="media-tabs">
                            <button class="tab-btn active" onclick="switchMediaTab('upload')">Upload</button>
                            <button class="tab-btn" onclick="switchMediaTab('library')">My Library</button>
                            <button class="tab-btn" onclick="switchMediaTab('stock')">Stock Media</button>
                        </div>
                        <div class="media-actions">
                            <input type="search" class="form-control" placeholder="Search media...">
                            <select class="form-control">
                                <option>All Types</option>
                                <option>Images</option>
                                <option>Videos</option>
                                <option>Audio</option>
                                <option>Documents</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="media-content">
                        <div class="media-upload-section">
                            <div class="upload-dropzone">
                                <span class="upload-icon">üìÅ</span>
                                <h4>Drag files here or click to upload</h4>
                                <p>Support for images, videos, audio, and documents</p>
                                <button class="btn btn-primary">Choose Files</button>
                            </div>
                        </div>
                        
                        <div class="media-grid">
                            <!-- Media items would be populated here -->
                            <div class="media-item">
                                <div class="media-preview">
                                    <span class="media-type-icon">üé•</span>
                                </div>
                                <div class="media-info">
                                    <div class="media-name">podcast-intro.mp4</div>
                                    <div class="media-meta">2.4 MB ‚Ä¢ Video</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMediaLibrary()">Cancel</button>
                <button class="btn btn-primary" onclick="insertSelectedMedia()">Insert Media</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/navigation.js"></script>
    <script src="js/include-navigation.js"></script>
    <script>
        // Lesson Content Editor JavaScript
        
        let lessonData = {
            id: 'lesson_1_2',
            title: 'Podcast Types and Formats',
            description: 'Explore the diverse world of podcast formats and discover which style best fits your content and audience goals.',
            blocks: [],
            settings: {
                status: 'draft',
                duration: 45,
                allowDownloads: true,
                requireCompletion: false,
                enableComments: false
            }
        };

        let isModified = false;
        let autoSaveInterval;

        // Initialize editor
        document.addEventListener('DOMContentLoaded', () => {
            setupEditor();
            setupAutoSave();
            setupDragAndDrop();
            loadLessonData();
        });

        function setupEditor() {
            // Setup rich text editors
            setupRichTextEditors();
            
            // Setup content block interactions
            setupBlockHandlers();
            
            // Setup keyboard shortcuts
            setupKeyboardShortcuts();
            
            // Track modifications
            document.addEventListener('input', () => {
                markAsModified();
            });
        }

        function setupAutoSave() {
            autoSaveInterval = setInterval(() => {
                if (isModified) {
                    autoSave();
                }
            }, 30000); // Auto-save every 30 seconds
        }

        function setupDragAndDrop() {
            // Enable drag and drop for content blocks
            const canvas = document.getElementById('contentBlocks');
            
            // Allow dropping elements from sidebar
            const elementItems = document.querySelectorAll('.element-item');
            elementItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', item.dataset.type);
                });
            });
            
            // Setup drop zone
            const dropZone = document.getElementById('dropZone');
            dropZone.addEventListener('click', () => {
                showAddElementMenu();
            });
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('drag-over');
            });
            
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('drag-over');
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('drag-over');
                const elementType = e.dataTransfer.getData('text/plain');
                if (elementType) {
                    addElement(elementType);
                }
            });
        }

        function setupRichTextEditors() {
            const editors = document.querySelectorAll('.rte-content');
            editors.forEach(editor => {
                // Add focus/blur handlers
                editor.addEventListener('focus', (e) => {
                    e.target.closest('.rich-text-editor').classList.add('focused');
                });
                
                editor.addEventListener('blur', (e) => {
                    e.target.closest('.rich-text-editor').classList.remove('focused');
                });
                
                // Add input handler for word count
                editor.addEventListener('input', () => {
                    updateWordCount();
                    markAsModified();
                });
            });
        }

        function setupBlockHandlers() {
            // Setup block interaction handlers
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('block-btn')) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            });
        }

        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch (e.key) {
                        case 's':
                            e.preventDefault();
                            saveDraft();
                            break;
                        case 'z':
                            e.preventDefault();
                            if (e.shiftKey) {
                                redoAction();
                            } else {
                                undoAction();
                            }
                            break;
                        case 'p':
                            e.preventDefault();
                            previewLesson();
                            break;
                    }
                }
            });
        }

        // Content Management Functions
        function addElement(type) {
            const blockId = Date.now();
            const blockHtml = generateBlockHTML(type, blockId);
            
            const dropZone = document.getElementById('dropZone');
            dropZone.insertAdjacentHTML('beforebegin', blockHtml);
            
            // Focus new block
            const newBlock = document.querySelector(`[data-block-id="${blockId}"]`);
            focusBlock(newBlock);
            
            markAsModified();
        }

        function generateBlockHTML(type, blockId) {
            const templates = {
                text: `
                    <div class="content-block" data-block-id="${blockId}" data-type="text">
                        <div class="block-controls">
                            <div class="block-handle">‚â°</div>
                            <div class="block-type-indicator">üìù Text</div>
                            <div class="block-actions">
                                <button class="block-btn" onclick="duplicateBlock(${blockId})">üìã</button>
                                <button class="block-btn" onclick="moveBlockUp(${blockId})">‚Üë</button>
                                <button class="block-btn" onclick="moveBlockDown(${blockId})">‚Üì</button>
                                <button class="block-btn danger" onclick="deleteBlock(${blockId})">üóëÔ∏è</button>
                            </div>
                        </div>
                        <div class="block-content">
                            <div class="rich-text-editor">
                                <div class="rte-toolbar">
                                    <button class="rte-btn" onclick="formatText('bold')"><b>B</b></button>
                                    <button class="rte-btn" onclick="formatText('italic')"><i>I</i></button>
                                    <button class="rte-btn" onclick="formatText('underline')"><u>U</u></button>
                                    <span class="toolbar-separator">|</span>
                                    <button class="rte-btn" onclick="insertList('ul')">‚Ä¢ List</button>
                                    <button class="rte-btn" onclick="insertList('ol')">1. List</button>
                                    <span class="toolbar-separator">|</span>
                                    <button class="rte-btn" onclick="insertLink()">üîó</button>
                                    <button class="rte-btn" onclick="insertImage()">üñºÔ∏è</button>
                                </div>
                                <div class="rte-content" contenteditable="true">
                                    <p>Start writing your content here...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `,
                video: `
                    <div class="content-block" data-block-id="${blockId}" data-type="video">
                        <div class="block-controls">
                            <div class="block-handle">‚â°</div>
                            <div class="block-type-indicator">üé• Video</div>
                            <div class="block-actions">
                                <button class="block-btn" onclick="duplicateBlock(${blockId})">üìã</button>
                                <button class="block-btn" onclick="moveBlockUp(${blockId})">‚Üë</button>
                                <button class="block-btn" onclick="moveBlockDown(${blockId})">‚Üì</button>
                                <button class="block-btn danger" onclick="deleteBlock(${blockId})">üóëÔ∏è</button>
                            </div>
                        </div>
                        <div class="block-content">
                            <div class="video-upload-area" onclick="uploadVideo(${blockId})">
                                <div class="upload-placeholder">
                                    <span class="upload-icon">üé•</span>
                                    <h4>Add Video Content</h4>
                                    <p>Click to upload video file or paste URL</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            };
            
            return templates[type] || templates.text;
        }

        function duplicateBlock(blockId) {
            const block = document.querySelector(`[data-block-id="${blockId}"]`);
            if (block) {
                const newBlockId = Date.now();
                const clone = block.cloneNode(true);
                clone.dataset.blockId = newBlockId;
                
                // Update onclick handlers
                const buttons = clone.querySelectorAll('[onclick*="' + blockId + '"]');
                buttons.forEach(btn => {
                    btn.setAttribute('onclick', btn.getAttribute('onclick').replace(blockId, newBlockId));
                });
                
                block.insertAdjacentElement('afterend', clone);
                markAsModified();
            }
        }

        function moveBlockUp(blockId) {
            const block = document.querySelector(`[data-block-id="${blockId}"]`);
            const previousBlock = block.previousElementSibling;
            
            if (previousBlock && previousBlock.classList.contains('content-block')) {
                previousBlock.insertAdjacentElement('beforebegin', block);
                markAsModified();
            }
        }

        function moveBlockDown(blockId) {
            const block = document.querySelector(`[data-block-id="${blockId}"]`);
            const nextBlock = block.nextElementSibling;
            
            if (nextBlock && nextBlock.classList.contains('content-block')) {
                nextBlock.insertAdjacentElement('afterend', block);
                markAsModified();
            }
        }

        function deleteBlock(blockId) {
            if (confirm('Are you sure you want to delete this content block?')) {
                const block = document.querySelector(`[data-block-id="${blockId}"]`);
                if (block) {
                    block.remove();
                    markAsModified();
                }
            }
        }

        function focusBlock(block) {
            // Remove focus from other blocks
            document.querySelectorAll('.content-block.focused').forEach(b => {
                b.classList.remove('focused');
            });
            
            // Add focus to target block
            block.classList.add('focused');
            
            // Scroll into view if needed
            block.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Rich Text Editor Functions
        function formatText(command) {
            document.execCommand(command, false, null);
            markAsModified();
        }

        function insertList(listType) {
            const command = listType === 'ul' ? 'insertUnorderedList' : 'insertOrderedList';
            document.execCommand(command, false, null);
            markAsModified();
        }

        function insertLink() {
            const url = prompt('Enter URL:');
            if (url) {
                document.execCommand('createLink', false, url);
                markAsModified();
            }
        }

        function insertImage() {
            // Open media library or file picker
            openMediaLibrary('image');
        }

        function insertEmbed() {
            const embedCode = prompt('Enter embed code or URL:');
            if (embedCode) {
                // Process and insert embed
                insertEmbedContent(embedCode);
                markAsModified();
            }
        }

        // Media Functions
        function openMediaLibrary(type = 'all') {
            document.getElementById('mediaLibraryModal').style.display = 'flex';
            // Load media based on type
        }

        function closeMediaLibrary() {
            document.getElementById('mediaLibraryModal').style.display = 'none';
        }

        function switchMediaTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Show corresponding content
            console.log(`Switching to ${tab} tab`);
        }

        function insertSelectedMedia() {
            // Insert selected media into current editor
            closeMediaLibrary();
        }

        function uploadVideo(blockId) {
            // Handle video upload
            console.log(`Uploading video for block ${blockId}`);
            openMediaLibrary('video');
        }

        function uploadAudio(blockId) {
            // Handle audio upload
            console.log(`Uploading audio for block ${blockId}`);
            openMediaLibrary('audio');
        }

        // Quiz Functions
        function addQuestion(quizBlockId) {
            const quizBlock = document.querySelector(`[data-block-id="${quizBlockId}"]`);
            const questionsContainer = quizBlock.querySelector('.quiz-questions');
            const questionCount = questionsContainer.children.length + 1;
            
            const questionHtml = `
                <div class="quiz-question" data-question="${questionCount}">
                    <div class="question-header">
                        <span class="question-number">Question ${questionCount}</span>
                        <select class="form-control question-type">
                            <option value="multiple-choice" selected>Multiple Choice</option>
                            <option value="true-false">True/False</option>
                            <option value="short-answer">Short Answer</option>
                        </select>
                        <button class="btn-icon" onclick="deleteQuestion(${questionCount})">üóëÔ∏è</button>
                    </div>
                    <div class="question-content">
                        <input type="text" class="form-control question-text" placeholder="Enter your question...">
                        <div class="question-options">
                            <div class="option-item">
                                <input type="radio" name="q${questionCount}" id="q${questionCount}a">
                                <input type="text" class="form-control option-text" placeholder="Option A">
                                <button class="btn-icon" onclick="toggleCorrect(this)">Make Correct</button>
                                <button class="btn-icon" onclick="removeOption(this)">‚úï</button>
                            </div>
                        </div>
                        <div class="question-actions">
                            <button class="btn btn-secondary btn-sm" onclick="addOption(${questionCount})">Add Option</button>
                        </div>
                    </div>
                </div>
            `;
            
            questionsContainer.insertAdjacentHTML('beforeend', questionHtml);
            markAsModified();
        }

        function deleteQuestion(questionNum) {
            if (confirm('Delete this question?')) {
                const question = document.querySelector(`[data-question="${questionNum}"]`);
                if (question) {
                    question.remove();
                    markAsModified();
                }
            }
        }

        function addOption(questionNum) {
            const question = document.querySelector(`[data-question="${questionNum}"]`);
            const optionsContainer = question.querySelector('.question-options');
            const optionCount = optionsContainer.children.length;
            const optionLetter = String.fromCharCode(97 + optionCount); // a, b, c, d...
            
            const optionHtml = `
                <div class="option-item">
                    <input type="radio" name="q${questionNum}" id="q${questionNum}${optionLetter}">
                    <input type="text" class="form-control option-text" placeholder="Option ${optionLetter.toUpperCase()}">
                    <button class="btn-icon" onclick="toggleCorrect(this)">Make Correct</button>
                    <button class="btn-icon" onclick="removeOption(this)">‚úï</button>
                </div>
            `;
            
            optionsContainer.insertAdjacentHTML('beforeend', optionHtml);
            markAsModified();
        }

        function removeOption(button) {
            button.closest('.option-item').remove();
            markAsModified();
        }

        function toggleCorrect(button) {
            const optionItem = button.closest('.option-item');
            const radio = optionItem.querySelector('input[type="radio"]');
            
            // Uncheck other options in the same question
            const questionContainer = optionItem.closest('.quiz-question');
            questionContainer.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
            
            // Check this option
            radio.checked = true;
            
            // Update button text and styling
            questionContainer.querySelectorAll('.option-item').forEach(item => {
                const btn = item.querySelector('.btn-icon');
                if (item === optionItem) {
                    btn.textContent = '‚úì Correct';
                    btn.classList.add('correct');
                    item.classList.add('correct');
                } else {
                    btn.textContent = 'Make Correct';
                    btn.classList.remove('correct');
                    item.classList.remove('correct');
                }
            });
            
            markAsModified();
        }

        function previewQuiz(blockId) {
            // Open quiz preview
            window.open(`quiz-preview.html?block=${blockId}`, '_blank');
        }

        // Utility Functions
        function markAsModified() {
            isModified = true;
            updateSaveStatus('unsaved');
        }

        function updateSaveStatus(status) {
            const indicator = document.getElementById('saveIndicator');
            const autoSaveStatus = document.getElementById('autoSaveStatus');
            
            switch (status) {
                case 'saved':
                    indicator.textContent = 'Saved';
                    indicator.className = 'save-indicator saved';
                    autoSaveStatus.innerHTML = '<span class="status-icon">‚úì</span><span class="status-text">Saved</span>';
                    autoSaveStatus.className = 'auto-save-status saved';
                    break;
                case 'saving':
                    indicator.textContent = 'Saving...';
                    indicator.className = 'save-indicator saving';
                    autoSaveStatus.innerHTML = '<span class="status-icon">‚è≥</span><span class="status-text">Saving...</span>';
                    autoSaveStatus.className = 'auto-save-status saving';
                    break;
                case 'unsaved':
                    indicator.textContent = 'Unsaved';
                    indicator.className = 'save-indicator unsaved';
                    autoSaveStatus.innerHTML = '<span class="status-icon">‚óè</span><span class="status-text">Unsaved changes</span>';
                    autoSaveStatus.className = 'auto-save-status unsaved';
                    break;
            }
        }

        function updateWordCount() {
            const editors = document.querySelectorAll('.rte-content');
            let totalWords = 0;
            
            editors.forEach(editor => {
                const text = editor.textContent || editor.innerText || '';
                const words = text.trim().split(/\s+/).filter(word => word.length > 0);
                totalWords += words.length;
            });
            
            document.getElementById('wordCount').textContent = totalWords.toLocaleString();
        }

        function autoSave() {
            if (!isModified) return;
            
            updateSaveStatus('saving');
            
            // Simulate API call
            setTimeout(() => {
                isModified = false;
                updateSaveStatus('saved');
            }, 1000);
        }

        function saveDraft() {
            updateSaveStatus('saving');
            collectLessonData();
            
            // Simulate API call
            setTimeout(() => {
                isModified = false;
                updateSaveStatus('saved');
                showNotification('Draft saved successfully!', 'success');
            }, 1500);
        }

        function collectLessonData() {
            // Collect all lesson data for saving
            const title = document.querySelector('.lesson-title-input').value;
            const description = document.querySelector('.lesson-description-input').value;
            
            lessonData.title = title;
            lessonData.description = description;
            
            // Collect all content blocks
            lessonData.blocks = [];
            document.querySelectorAll('.content-block').forEach(block => {
                const blockData = {
                    id: block.dataset.blockId,
                    type: block.dataset.type,
                    content: extractBlockContent(block)
                };
                lessonData.blocks.push(blockData);
            });
            
            return lessonData;
        }

        function extractBlockContent(block) {
            const type = block.dataset.type;
            
            switch (type) {
                case 'text':
                    return {
                        html: block.querySelector('.rte-content').innerHTML
                    };
                case 'video':
                    return {
                        url: block.querySelector('input[type="url"]')?.value || '',
                        title: block.querySelector('.form-control')?.value || '',
                        settings: {}
                    };
                case 'quiz':
                    const questions = [];
                    block.querySelectorAll('.quiz-question').forEach(q => {
                        const questionData = {
                            text: q.querySelector('.question-text').value,
                            type: q.querySelector('.question-type').value,
                            options: [],
                            correct: null
                        };
                        
                        q.querySelectorAll('.option-item').forEach((opt, index) => {
                            questionData.options.push({
                                text: opt.querySelector('.option-text').value,
                                correct: opt.querySelector('input[type="radio"]').checked
                            });
                            
                            if (opt.querySelector('input[type="radio"]').checked) {
                                questionData.correct = index;
                            }
                        });
                        
                        questions.push(questionData);
                    });
                    
                    return {
                        title: block.querySelector('.quiz-title').value,
                        description: block.querySelector('.quiz-description').value,
                        questions: questions
                    };
                default:
                    return {};
            }
        }

        function loadLessonData() {
            // Load existing lesson data
            console.log('Loading lesson data...');
            updateWordCount();
        }

        function previewLesson() {
            collectLessonData();
            window.open('lesson-preview.html', '_blank');
        }

        function publishLesson() {
            if (confirm('Are you sure you want to publish this lesson? It will be available to students immediately.')) {
                collectLessonData();
                lessonData.settings.status = 'published';
                
                updateSaveStatus('saving');
                
                // Simulate API call
                setTimeout(() => {
                    updateSaveStatus('saved');
                    showNotification('Lesson published successfully!', 'success');
                }, 2000);
            }
        }

        function showNotification(message, type = 'info') {
            // Create and show notification
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }

        // Floating Action Panel
        function togglePanel() {
            const menu = document.getElementById('fabMenu');
            const toggle = document.getElementById('fabToggle');
            
            if (menu.style.display === 'none') {
                menu.style.display = 'flex';
                toggle.classList.add('open');
            } else {
                menu.style.display = 'none';
                toggle.classList.remove('open');
            }
        }

        // Action Functions
        function undoAction() {
            document.execCommand('undo', false, null);
        }

        function redoAction() {
            document.execCommand('redo', false, null);
        }

        function togglePreview() {
            const canvas = document.getElementById('contentCanvas');
            const button = document.getElementById('previewToggle');
            
            canvas.classList.toggle('preview-mode');
            
            if (canvas.classList.contains('preview-mode')) {
                button.innerHTML = '<span class="icon">‚úèÔ∏è</span>';
                button.title = 'Edit Mode';
            } else {
                button.innerHTML = '<span class="icon">üëÅÔ∏è</span>';
                button.title = 'Preview Mode';
            }
        }

        function showOutline() {
            // Show lesson outline/structure
            alert('Lesson outline feature - coming soon!');
        }

        function showAddElementMenu() {
            // Show context menu for adding elements
            togglePanel();
        }

        // Initialize word count
        updateWordCount();
    </script>

    <style>
        /* Lesson Content Editor Specific Styles */
        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: var(--white);
            border-radius: var(--card-border-radius);
            box-shadow: var(--shadow);
        }

        .breadcrumb {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .breadcrumb-separator {
            margin: 0 0.5rem;
        }

        .lesson-info {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-top: 0.5rem;
        }

        .lesson-separator {
            margin: 0 0.5rem;
        }

        .editor-actions {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .save-indicator {
            font-size: 0.75rem;
            margin-left: 0.5rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .save-indicator.saved {
            background: var(--quiz-correct);
            color: var(--lesson-success);
        }

        .save-indicator.saving {
            background: #fef3c7;
            color: var(--lesson-warning);
        }

        .save-indicator.unsaved {
            background: var(--quiz-incorrect);
            color: var(--danger-color);
        }

        /* Editor Layout */
        .editor-layout {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 1.5rem;
            min-height: calc(100vh - 200px);
        }

        .editor-sidebar {
            background: var(--white);
            border-radius: var(--card-border-radius);
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .sidebar-section {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-section:last-child {
            border-bottom: none;
        }

        .sidebar-section h3 {
            margin-bottom: 1rem;
            font-size: 1rem;
            color: var(--text-color);
        }

        /* Lesson Navigation */
        .lesson-navigation {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .lesson-nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lesson-nav-item:hover {
            border-color: var(--primary-color);
            background: #fff7ed;
        }

        .lesson-nav-item.current {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }

        .lesson-nav-item.completed {
            border-color: var(--lesson-success);
            background: var(--quiz-correct);
        }

        .lesson-status {
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }

        .lesson-nav-title {
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Elements Library */
        .elements-library {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .element-category h4 {
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .element-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: grab;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
        }

        .element-item:hover {
            border-color: var(--primary-color);
            background: #fff7ed;
            transform: translateX(4px);
        }

        .element-item:active {
            cursor: grabbing;
        }

        .element-icon {
            font-size: 1.25rem;
        }

        .element-name {
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Lesson Settings */
        .lesson-settings {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .setting-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-color);
        }

        .duration-inputs {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 0.5rem;
        }

        /* Main Editor */
        .editor-main {
            background: var(--white);
            border-radius: var(--card-border-radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            min-height: 800px;
        }

        /* Editor Toolbar */
        .editor-toolbar-main {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: #f8fafc;
            border-radius: var(--card-border-radius) var(--card-border-radius) 0 0;
        }

        .toolbar-section {
            display: flex;
            gap: 0.25rem;
        }

        .toolbar-btn {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            background: var(--white);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toolbar-btn:hover {
            border-color: var(--primary-color);
            background: #fff7ed;
        }

        .toolbar-divider {
            width: 1px;
            height: 24px;
            background: var(--border-color);
            margin: 0 0.5rem;
        }

        .toolbar-spacer {
            flex: 1;
        }

        .word-count,
        .auto-save-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .auto-save-status.saved {
            color: var(--lesson-success);
        }

        .auto-save-status.saving {
            color: var(--lesson-warning);
        }

        .auto-save-status.unsaved {
            color: var(--danger-color);
        }

        /* Content Canvas */
        .content-canvas {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .lesson-header-editor {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #f8fafc;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }

        .lesson-title-input {
            width: 100%;
            font-size: 1.5rem;
            font-weight: 600;
            border: none;
            background: transparent;
            padding: 0.5rem 0;
            margin-bottom: 0.75rem;
        }

        .lesson-title-input:focus {
            outline: none;
            border-bottom: 2px solid var(--primary-color);
        }

        .lesson-description-input {
            width: 100%;
            border: none;
            background: transparent;
            resize: vertical;
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .lesson-description-input:focus {
            outline: none;
        }

        /* Content Blocks */
        .content-blocks {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .content-block {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .content-block:hover {
            box-shadow: var(--shadow);
        }

        .content-block.focused {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(247, 155, 91, 0.1);
        }

        .block-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background: #f8fafc;
            border-bottom: 1px solid var(--border-color);
            border-radius: 8px 8px 0 0;
        }

        .block-handle {
            cursor: grab;
            color: var(--text-light);
            font-size: 1.25rem;
            padding: 0.25rem;
        }

        .block-handle:active {
            cursor: grabbing;
        }

        .block-type-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-color);
        }

        .block-actions {
            display: flex;
            gap: 0.25rem;
        }

        .block-btn {
            padding: 0.25rem 0.5rem;
            border: none;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .block-btn:hover {
            background: var(--border-color);
        }

        .block-btn.danger:hover {
            background: var(--quiz-incorrect);
            color: var(--danger-color);
        }

        .block-content {
            padding: 1.5rem;
        }

        /* Rich Text Editor */
        .rich-text-editor {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--white);
        }

        .rich-text-editor.focused {
            border-color: var(--primary-color);
        }

        .rte-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            background: #f8fafc;
        }

        .rte-btn {
            padding: 0.375rem 0.75rem;
            border: 1px solid var(--border-color);
            background: var(--white);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .rte-btn:hover {
            border-color: var(--primary-color);
            background: #fff7ed;
        }

        .toolbar-separator {
            margin: 0 0.5rem;
            color: var(--text-light);
        }

        .rte-content {
            padding: 1rem;
            min-height: 200px;
            outline: none;
            line-height: 1.6;
        }

        .rte-content h2,
        .rte-content h3 {
            margin: 1rem 0 0.5rem 0;
        }

        .rte-content p {
            margin-bottom: 1rem;
        }

        .rte-content ul,
        .rte-content ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        /* Video Block */
        .video-block-editor {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .video-preview {
            background: #f8fafc;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
        }

        .video-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .video-info h4 {
            margin-bottom: 0.5rem;
        }

        .video-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .video-settings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* Quiz Block */
        .quiz-block-editor {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .quiz-header {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .quiz-title {
            font-size: 1.125rem;
            font-weight: 600;
            border: none;
            background: transparent;
            border-bottom: 1px solid var(--border-color);
            padding: 0.5rem 0;
        }

        .quiz-description {
            border: none;
            background: transparent;
            resize: vertical;
        }

        .quiz-questions {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .quiz-question {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            background: #f8fafc;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .question-number {
            font-weight: 600;
            color: var(--primary-color);
        }

        .question-type {
            max-width: 150px;
        }

        .question-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .question-text {
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-bottom: 1px solid var(--border-color);
            background: transparent;
            padding: 0.5rem 0;
        }

        .question-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }

        .option-item.correct {
            border-color: var(--lesson-success);
            background: var(--quiz-correct);
        }

        .option-text {
            flex: 1;
            border: none;
            background: transparent;
        }

        .option-text:focus {
            outline: none;
        }

        .question-actions {
            display: flex;
            gap: 0.5rem;
        }

        .question-settings {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .quiz-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Audio Block */
        .audio-block-editor {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .audio-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .audio-upload-area:hover {
            border-color: var(--primary-color);
            background: #fff7ed;
        }

        .upload-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .upload-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
        }

        .upload-options {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* Drop Zone */
        .content-drop-zone {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .content-drop-zone:hover,
        .content-drop-zone.drag-over {
            border-color: var(--primary-color);
            background: #fff7ed;
        }

        .drop-zone-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .drop-icon {
            font-size: 2rem;
            color: var(--primary-color);
        }

        /* Floating Action Panel */
        .floating-panel {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .fab-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .fab-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .fab-btn.open {
            transform: rotate(45deg);
        }

        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .fab-item {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--white);
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .fab-item:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }

        /* Media Library Modal */
        .modal.large .modal-content {
            max-width: 900px;
            max-height: 80vh;
        }

        .media-library {
            display: flex;
            flex-direction: column;
            height: 500px;
        }

        .media-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .media-tabs {
            display: flex;
            gap: 0.25rem;
        }

        .media-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .media-content {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .media-upload-section {
            margin-bottom: 2rem;
        }

        .upload-dropzone {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 3rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .upload-dropzone:hover {
            border-color: var(--primary-color);
            background: #fff7ed;
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .media-item {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .media-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .media-preview {
            margin-bottom: 0.75rem;
        }

        .media-type-icon {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .media-name {
            font-weight: 500;
            margin-bottom: 0.25rem;
            font-size: 0.875rem;
        }

        .media-meta {
            font-size: 0.75rem;
            color: var(--text-light);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid var(--lesson-success);
            background: var(--quiz-correct);
        }

        .notification.error {
            border-left: 4px solid var(--danger-color);
            background: var(--quiz-incorrect);
        }

        /* Preview Mode */
        .content-canvas.preview-mode .block-controls {
            display: none;
        }

        .content-canvas.preview-mode .content-block {
            border: none;
            box-shadow: none;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .editor-layout {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .editor-sidebar {
                position: relative;
                top: auto;
            }
            
            .floating-panel {
                bottom: 20px;
                right: 20px;
            }
        }

        @media (max-width: 768px) {
            .editor-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .editor-actions {
                justify-content: stretch;
                flex-wrap: wrap;
            }

            .editor-toolbar-main {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .content-canvas {
                padding: 1rem;
            }

            .video-settings {
                grid-template-columns: 1fr;
            }

            .quiz-actions {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
        }

        @media (max-width: 480px) {
            .rte-toolbar {
                flex-wrap: wrap;
                gap: 0.125rem;
            }

            .rte-btn {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
            }

            .block-actions {
                flex-wrap: wrap;
            }

            .floating-panel {
                bottom: 15px;
                right: 15px;
            }

            .fab-btn {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }

            .fab-item {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
        }
    </style>
</body>
</html>